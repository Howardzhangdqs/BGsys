<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>壁纸系统</title>
        <script src="jquery.min.js"></script>
		<link rel="stylesheet" type="text/css" href="main.css">
    </head>
    <body id="b" onselectstart="return false" onresize="changesize()" onchange="changesize()">
		<div class="boxxx">
			<div id="scheb1" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="schedule" id="sche1" ondragstart="drag(event)">Undef</div>
            </div>
            <div id="scheb2" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="schedule" id="sche2" ondragstart="drag(event)">Undef</div>
            </div>
            <div id="scheb3" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="schedule" id="sche3" ondragstart="drag(event)">Undef</div>
            </div>
            <div id="scheb4" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="schedule" id="sche4" ondragstart="drag(event)">Undef</div>
            </div>
            <div id="scheb5" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="schedule" id="sche5" ondragstart="drag(event)">Undef</div>
            </div>
            <div id="scheb6" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="schedule" id="sche6" ondragstart="drag(event)">Undef</div>
            </div>
            <div id="scheb7" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="schedule" id="sche7" ondragstart="drag(event)">Undef</div>
            </div>
            <div id="scheb8" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="schedule" id="sche8" ondragstart="drag(event)">Undef</div>
            </div>
            <div id="scheb9" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="schedule" id="sche9" ondragstart="drag(event)">Undef</div>
            </div>
		</div>
		<div class="more" id="more1">
			<div class="sche" id="schem11" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="schedule" id="schm11" ondragstart="drag(event)">语文</div>
            </div>
            <div class="sche" id="schem12" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="schedule" id="schm12" ondragstart="drag(event)">数学</div>
            </div>
            <div class="sche" id="schem13" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="schedule" id="schm13" ondragstart="drag(event)">英语</div>
            </div>
            <div class="sche" id="schem14" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="schedule" id="schm14" ondragstart="drag(event)">物理</div>
            </div>
            <div class="sche" id="schem15" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="schedule" id="schm15" ondragstart="drag(event)">化学</div>
            </div>
            <div class="sche" id="schem16" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="schedule" id="schm16" ondragstart="drag(event)">政治</div>
            </div>
            <div class="sche" id="schem17" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="schedule" id="schm17" ondragstart="drag(event)">历史</div>
            </div>
            <div class="sche" id="schem18" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="schedule" id="schm18" ondragstart="drag(event)">地理</div>
            </div>
			<div class="sche" id="schem11" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="schedule" id="schm19" ondragstart="drag(event)">生物</div>
            </div>
		</div>
		<div class="more" id="more2">
			<div class="sche" id="schem21" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="schedule" id="schm21" ondragstart="drag(event)">班会</div>
            </div>
            <div class="sche" id="schem22" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="schedule" id="schm22" ondragstart="drag(event)">信息</div>
            </div>
            <div class="sche" id="schem23" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="schedule" id="schm23" ondragstart="drag(event)">心理</div>
            </div>
            <div class="sche" id="schem24" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="schedule" id="schm24" ondragstart="drag(event)">体锻</div>
            </div>
            <div class="sche" id="schem25" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="schedule" id="schm25" ondragstart="drag(event)">体专</div>
            </div>
            <div class="sche" id="schem26" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="schedule" id="schm26" ondragstart="drag(event)">拓研</div>
            </div>
            <div class="sche" id="schem27" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="schedule" id="schm27" ondragstart="drag(event)">数测</div>
            </div>
            <div class="sche" id="schem28" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="schedule" id="schm28" ondragstart="drag(event)">劳技</div>
            </div>
            <div class="sche" id="schem28" ondrop="drop(event)" ondragover="allowDrop(event)">
                <div class="schedule" id="schm29" ondragstart="drag(event)">艺术</div>
            </div>
		</div>
		<div class="boxx">
            <div class="silent" style="font-size: 300%; text-align: center; display: none; margin: 20px;">安静</div>
            <table border="0">
                <div class="timer" style="padding:40px !important; ">
                    <div class="eachline active" id="timer">time</div>
                    <div class="eachline active" id="dater">time</div>
                </div>
                <tr class="other">
                    <td>
                        <div class="linehead">值日班长：</div>
                    </td>
                    <td>
                        <div class="eachline" id="work0">charge</div>
                    </td>
                </tr>
                <tr class="blackboard">
                    <td>
                        <div class="linehead">擦黑板：</div>
                    </td>
                    <td>
                        <div class="eachline" id="work1">blackboard</div>
                    </td>
                </tr>
                <tr class="other">
                    <td>
                        <div class="linehead">整理+擦讲台：</div>
                    </td>
                    <td>
                        <div class="eachline" id="work2">arrange</div>
                    </td>
                </tr>
                <tr class="other">
                    <td>
                        <div class="linehead">扫地：</div>
                    </td>
                    <td>
                        <div class="eachline" id="work3">sweep</div>
                    </td>
                </tr>
                <tr class="other">
                    <td>
                        <div class="linehead">拖地：</div>
                    </td>
                    <td>
                        <div class="eachline" id="work4">mop</div>
                    </td>
                </tr>
                <tr class="other">
                    <td>
                        <div class="linehead">排桌椅+关窗：</div>
                    </td>
                    <td>
                        <div class="eachline" id="work5">arrange_tables</div>
                    </td>
                </tr>
            </table>
            <div style="padding:40px;"></div>
        </div>
        <div class="tool_bar" style="" align="center" onselectstart="return false">
			<a href="bulletin.html">
				<span href="bulletin.html">公告板</span>
			</a>
			<span id="editt" onclick="editt()">编辑课程表</span>
        </div>
		<script>
			/* 常用函数 */
			
			/* 日期格式化 */
            Date.prototype.format = function(fmt) {
                var o = {
                    "M+": this.getMonth() + 1,
                    "d+": this.getDate(),
                    "h+": this.getHours(),
                    "m+": this.getMinutes(),
                    "s+": this.getSeconds(),
                    "q+": Math.floor((this.getMonth() + 3) / 3),
                    "S": this.getMilliseconds()
                };
                if (/(y+)/.test(fmt))
                    fmt = fmt.replace(RegExp.$1, (this.getFullYear() + "").substr(4 - RegExp.$1.length));
                for (var k in o) {
                    if (new RegExp("(" + k + ")").test(fmt)) {
                        fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : (("00" + o[k]).substr(("" + o[k]).length)));
                    }
                }
                return fmt;
            }
			
			/* 判断字符串是否为空 */
			function isEmpty(obj){
				if (typeof obj == "undefined" || obj == null || obj == "") return true;
				else return false;
			}

		</script>
		<script>
			var edit_on = false;
			
			/* 布局适应 模块 */
			function changesize() {
				var ddch = document.documentElement.clientHeight;
				var ddcw = document.documentElement.clientWidth;
				var boxxx = $(".boxxx");
				var more = $(".more");
				$(".boxxx").css("right", "10px");
				$(".boxxx").css("top", ((ddch - boxxx.height()) / 2) + "px");
				
				$(".more").css("top", ((ddch - more.height()) / 2) + "px");
				$("#more1").css("right", (boxxx.width() + 20) + "px");
				$("#more2").css("right", (boxxx.width() * 2 + 20) + "px");
				$("#more1").css("font-size", "40px");
				$("#more2").css("font-size", "40px");
				
				if (! edit_on) $(".more").css({"display": "none", "opacity": "0"});
				else $(".more").css({"display": "block", "opacity": "1"});
				
                $("body").css("width", ddcw + "px");
                $("body").css("height", ddch + "px");
			}
			
            window.onload = function() {
				changesize();
			}
			
			var pid = "", nid = "", apid = "";
			
			/* 拖动 模块 */
			var fro;
			
			function editt() {
				edit_on = ! edit_on;
				if (edit_on) {
					$("#editt").text("编辑中");
					$(".boxx").css("opacity", "0.3");
					$(".more").css("display", "block");
					$(".more").css("opacity", "0");
					$(".more").animate({"opacity": "1"}, 500);
					$(".schedule").attr("draggable", "true");
				} else {
					$("#editt").text("编辑课程表");
					$(".boxx").css("opacity", "1");
					$(".more").css("opacity", "0");
					$(".more").css("display", "none");
					$(".schedule").attr("draggable", "false");
				}
			}
			
			function allowDrop(ev) {
				if (! edit_on) return;
				if (ev.target.id == fro.id) return;
				console.log(ev.target.id[3]);
				if (ev.target.id[3] == 'm') return;
				ev.preventDefault();
			}
			 
			function drag(ev) {
				if (! edit_on) return;
				ev.dataTransfer.setData("Text",ev.target.id);
				fro = ev.target;
			}
			 
			function drop(ev) {
				if (! edit_on) return;
				ev.preventDefault();
				var data = ev.dataTransfer.getData("Text");
				
				if (ev.target.id == fro.id) return;
				console.log(ev.target.id[3]);
				if (ev.target.id[3] == 'm') return;
				
				var tar = ev.target;
				var tar_text = tar.innerHTML;
				var tar_id = ev.target.id;
				//fro = tar.innerHTML;
				tar.innerHTML = (document.getElementById(data).innerHTML);
				tar = tar.firstChild;
				tar.id = tar_id;
				console.log(fro.id[3]);
				if (fro.id[3] != 'm') fro.innerHTML = tar_text;
			}
			
			
			/* 时间、课程表、值日表 模块 */
            window.onload = function() {
                $(".blackboard").addClass("active");

                var data = [["佘轶舟", "史炜乐", "李予心", "齐欣怡 王屹杨", "卫澜 黄语菲", "刘豫皖"], ["任思渔", "张煜琀", "吴嘉雯", "沈筱祎 邵思晴", "赵国桓 邓湛", "任思渔"], ["严睿扬", "张金皓", "张伊容", "邵亦涵 陈麟杰", "严睿扬 张既同", "张嘉怡"], ["温璐宁", "桂诗韵", "金品希", "郁佳一", "周津仕 金泰仰", "秦黄蕊"], ["梁彦欣", "顾思仪", "曹锦秀", "黄思绮 费云帆", "胡健宇 蒋奕铭", "魏舒天"]];
				var sche = [
					["数学", "信息", "语文", "外语", "体锻", "生物", "政治", "化学", "物理"],
					["地理", "数学", "历史", "体专", "体专", "语文", "外语", "拓研", "拓研"],
					["外语", "生物", "艺术", "数学", "数学", "物理", "语文", "心理", "化学"],
					["语文", "历史", "物理", "体育", "政治", "外语", "数学", "劳技", "数测"],
					["地理", "体育", "外语", "语文", "化学", "数学", "信息", "班会"]
				];
				
				var pre = new Date(); // "2021/12/2 21:00:00"
                var day = pre.getDay() - 1;
                var str = pre.format("yyyy年MM月dd日");
				$("#dater").text(str);

                for (var i = 0; i <= 5; i ++)
                    $("#work" + i).text(data[day][i]);
				
                for (var i = 1; i <= 9; i ++) {
					if (! isEmpty(sche[day][i - 1])) $("#sche" + i).text(sche[day][i - 1]);
					else {
						$("#sche" + i).css("display", "none");
						changesize();
					}
				}
				
                var now = pre.getTime();
                now %= 60 * 60 * 24 * 1000;
                str = pre.format("hh:mm");
				$("#timer").text(str);
				
				changesize();
				
                setInterval(function() {
					changesize();
                    pre = new Date();
                    now = pre.getTime();
                    now %= 60 * 60 * 24 * 1000;
                    str = pre.format("hh:mm");
					$("#timer").text(str);
                    if (now >= 16200000 && now <= 18300000) {
                        $(".other").css("display", "none");
                        $(".silent").css("display", "block");
                    } else {
                        $(".other").css("display", "table-row");
                        $(".silent").css("display", "none");
                    }
                }, 1000);

            }
        </script>
    </body>
</html>
